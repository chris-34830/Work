=LAMBDA(Rés;Suiv;Cr;Cs;LET(Hr;INDEX(Rés;1;);Dr;DROP(Rés;1);Hs;INDEX(Suiv;1;);Ds;DROP(Suiv;1);p;LAMBDA(k1;k2;LET(inR;ISNUMBER(MATCH(HSTACK(k1;k2);HSTACK(INDEX(Dr;;1);INDEX(Dr;;2));0)),inS;ISNUMBER(MATCH(HSTACK(k1;k2);HSTACK(INDEX(Ds;;1);INDEX(Ds;;2));0)),Cas;IF(inR*inS;"C";IF(inR;"R";"S")),Div;IF(inR*inS;TEXTJOIN(";",TRUE,BYCOL(Cr;LAMBDA(cR;LET(iR;MATCH(HSTACK(k1;k2);HSTACK(INDEX(Dr;;1);INDEX(Dr;;2));0),iS;MATCH(HSTACK(k1;k2);HSTACK(INDEX(Ds;;1);INDEX(Ds;;2));0),cS;INDEX(Cs;XMATCH(cR;Cr;0)),vR;INDEX(Dr;iR;XMATCH(cR;Hr;0)),vS;INDEX(Ds;iS;XMATCH(cS;Hs;0)),IF(vR<>vS;cR&":"&vR&"<>"&vS;"")))))));""),HSTACK(k1;k2;Cas;Div))));Tous;UNIQUE(VSTACK(HSTACK(INDEX(Dr;;1);INDEX(Dr;;2));HSTACK(INDEX(Ds;;1);INDEX(Ds;;2))));RésF;MAP(SEQUENCE(ROWS(Tous));LAMBDA(r;p(INDEX(Tous;r;1);INDEX(Tous;r;2))));VSTACK({"C1";"C2";"Cas";"Div"};RésF)))
